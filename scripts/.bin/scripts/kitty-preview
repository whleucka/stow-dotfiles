#!/usr/bin/env python3
import json, sys, pathlib

name = sys.argv[1]
f = pathlib.Path.home() / ".local/share/kitty-sessions" / (name + ".json")
if f.exists():
    data = json.load(open(f))
    for i, win in enumerate(data.get("windows", []), 1):
        print(f"Window {i}:")
        for j, tab in enumerate(win.get("tabs", []), 1):
            print(f"  Tab {j}: {tab.get('title','')} (layout: {tab.get('layout','')})")
            for k, w in enumerate(tab.get("windows", []), 1):
                loc = w.get("location", "")
                cwd = w.get("cwd", "")
                cmd = " ".join(w.get("cmdline", []))
                print(f"    Split {k}: {loc}, cwd={cwd}, cmd={cmd}")
